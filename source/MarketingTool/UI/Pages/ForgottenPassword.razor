@page "/forgottenpassword"

@using DataTransfer.DataTransferObjects
@using DataTransfer.ViewModels

@inject HttpClient http
@inject NavigationManager nav

<div class="container text-center">
    <h3>Forgotten Password</h3>

    <p>Enter your email to reset your password</p>
    <EditForm Model="resetRequest" OnValidSubmit="HandleReset">
        <label>Enter Your Email Address</label>
        <InputText type="email" @bind-Value="resetRequest.Email" />
        <button type="submit" class="btn btn-primary">Reset Password</button>
    </EditForm>
</div>
@if (RequestComplete)
{
<p class="text-success">Check your email to complete your password reset</p>
}

@code {
    EmailObjectRequest resetRequest = new EmailObjectRequest();

    private bool RequestComplete = false;

    private async Task HandleReset()
    {
        var response = await http.PostAsJsonAsync("api/resetpassword/", resetRequest);

        if (response.IsSuccessStatusCode)
            RequestComplete = true;
    }
}
